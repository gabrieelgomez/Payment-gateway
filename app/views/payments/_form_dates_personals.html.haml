= simple_form_for @subscriber, :url => url_for(:action => 'checkout', :controller => 'payments'), :method => 'post' do |f|
  .tab-content
    #step1.tab-pane.active{:role => "tabpanel"}
      .step33
        %h5
          %strong Datos personales
        %hr
        .row.mar_ned
          .col-lg-2
            %p{:align => "right"}
              %stong Nombre (*)
          .col-lg-4
            = f.input :name, label: false, input_html: {"aria-invalid": "true", :autocomplete => "off", class:"dropselectsec", :placeholder => "Introduce tu nombre", :type => "text", required: "required"}

          .col-lg-2
            %p{:align => "right"}
              %stong E-mail (*)
          .col-lg-4
            = f.input :email, label: false, input_html: {"aria-invalid": "true", :autocomplete => "off", class:"dropselectsec", :placeholder => "Introduce tu email", :type => "email", required: "required"}

        .row.mar_ned
          .col-lg-2
            %p{:align => "right"}
              %stong Apellido (*)
          .col-lg-4
            = f.input :lastname, label: false, input_html: {"aria-invalid": "true", :autocomplete => "off", class:"dropselectsec", :placeholder => "Introduce tu apellido", :type => "text", required: "required"}

          .col-lg-2
            %p{:align => "right"}
              %stong Identidad (*)
          .col-lg-4
            = f.input :document_id, label: false, input_html: {"aria-invalid": "true", :autocomplete => "off", class:"dropselectsec", :placeholder => "Introduce tu identidad", :type => "text", required: "required"}

        .row.mar_ned
          .col-lg-2
            %p{:align => "right"}
              %stong Telefono Personal (*)
          .col-lg-4
            = f.input :phone_one, label: false, input_html: {"aria-invalid": "true", class:"dropselectsec", :placeholder => "Introduce tu telefono personal", :type => "text", required: "required"}

          .col-lg-2
            %p{:align => "right"}
              %stong Telefono Opcional
          .col-lg-4
            = f.input :phone_two, label: false, input_html: {class:"dropselectsec", :placeholder => "Introduce tu telefono de oficina", :type => "text", required: "required"}

        .row.mar_ned
          .col-lg-2
            %p{:align => "right"}
              %stong Direccion (*)
          .col-lg-3
            = f.input :address, as: :text, label: false, input_html: {"aria-invalid": "true", class:"form-control", :placeholder => "Introduce tu direccion", :type => "text", required: "required"}
            = f.input :course_id, label: false, :input_html => {class:"none-input", :value => "#{@course.id}" }
            = f.input :buyout, label: false, :input_html => {class:"none-input", :value => "#{@course.price_dolars}" }
        .row.mar_ned
      %ul.list-inline.pull-right
        -# %li
        -#   %button.btn.btn-default.prev-step{:type => "button"} Previous
        -# %li
        -#   %button.btn.btn-default.next-step{:type => "button"} Skip
        %li
          %button.btn.btn-primary.btn-info-full.next-step{:type => "button"} Guardar y continuar


    #step2.tab-pane{:role => "tabpanel"}
      .step33
        %h5
          %strong Detalles de pago
        %hr
        -if params[:method].eql?("paypal")
          .row.mar_ned
            .col-lg-2
              %p{:align => "right"}
                %stong= @course.course_name
          .row.mar_ned
            .col-lg-2
              %p{:align => "right"}
                $
                %stong= @course.price_dolars


            .center-f
              #payment-form
              %button.btn.btn-primary{:type => "submit"} Pagar
              %script{:src => "https://js.braintreegateway.com/js/braintree-2.20.0.min.js"}
        -else
          .center-f
            #payment-form
            %button.btn.btn-primary{:type => "submit"} Pagar

      %ul.list-inline.pull-right
        %li
          %button.btn.btn-primary.prev-step{:type => "button"} Previous
        -# %li
        -#   %button.btn.btn-primary.next-step{:type => "button"} Save and continue
    #complete.tab-pane{:role => "tabpanel"}
      %h3 Complete
      %p You have successfully completed all steps.
    .clearfix


:javascript
  $(document).ready(function () {
    //Initialize tooltips
    $('.nav-tabs > li a[title]').tooltip();

    //Wizard
    $('a[data-toggle="tab"]').on('show.bs.tab', function (e) {

        var $target = $(e.target);

        if ($target.parent().hasClass('disabled')) {
            return false;
        }
    });

    $(".next-step").click(function (e) {
      if (
        $("#subscriber_name").attr("aria-invalid")=="false" &&
        $("#subscriber_lastname").attr("aria-invalid")=="false" &&
        $("#subscriber_document_id").attr("aria-invalid")=="false" &&
        $("#subscriber_email").attr("aria-invalid")=="false" &&
        $("#subscriber_phone_one").attr("aria-invalid")=="false" &&
        $("#subscriber_address").attr("aria-invalid")=="false" ||
        
      ){
        var $active = $('.wizard .nav-tabs li.active');
        $active.next().removeClass('disabled');
        nextTab($active);
      }
    });
    $(".prev-step").click(function (e) {

        var $active = $('.wizard .nav-tabs li.active');
        prevTab($active);

    });


   validations = $("#new_subscriber").validate({
    event: "blur",
    rules: {
      'subscriber[name]': { required: true},
      'subscriber[lastname]': { required: true },
      'subscriber[document_id]': { required: true, minlength: 6, maxlength: 15 },
      'subscriber[email]': { required: true, email: true },
      'subscriber[phone_one]': { required: true, minlength: 7, maxlength: 15 },
      'subscriber[address]': { required: true },
      'braintree-dropin-frame': {required: true},
      },

    messages: {
      'subscriber[name]': "Indica tu nombre",
      'subscriber[lastname]': "Indica tu apellido",
      'subscriber[document_id]': "Tu identidad personal (C.I)",
      'subscriber[email]': "Introduce un email válido",
      'subscriber[phone_one]': "Introduce un teléfono entre 7 y 15 caracteres",
      'subscriber[address]': "Indica tu dirección",
      },
    debug: true,errorElement: "label",
    submitHandler: function(form){
      form.submit();
    }
  });
  });

  function nextTab(elem) {
    $(elem).next().find('a[data-toggle="tab"]').click();
  }
  function prevTab(elem) {
    $(elem).prev().find('a[data-toggle="tab"]').click();
  }

:scss
  .none-mp, .none-paypal{
  display: none;
  }

  .display-mp, .display-paypal{
  display: block;
  }

  .none-input{
  display: none;
  }

  .center-f {
  height: 100% !important;
  padding: 0 !important;
  margin: 0 !important;
  display: -webkit-box !important;
  display: -moz-box !important;
  display: -ms-flexbox !important;
  display: -webkit-flex !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  }

:javascript
  var clientToken = "#{@token}";

  braintree.setup(clientToken, "dropin", {
  container: "payment-form"
  });
